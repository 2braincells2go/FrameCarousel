/*! Frame Carousel - v0.1.0 - 2015-06-08
* http://www.eastros.com/frame-carousel/
* Copyright (c) 2015 Umar Ashfaq; Licensed MIT */
!function(a){function b(b,c){a.extend(this,{el:b,$el:a(b).data("frameCarousel",this),$:a.proxy(a.fn.find,a(b)),options:c||{},attributes:{},elements:{}}),f.call(this).then(a.proxy(function(){p.call(this),this["goto"](this.options.first,{animate:!1})},this))}var c="<div class='fc-controls'><a href='#' rel='go-left' class='fc-btn fc-btn-left'></a><a href='#' rel='go-right' class='fc-btn fc-btn-right'></a></div><div class='fc-pagination'><div class='fc-pagination-inner'></div></div><div class='fc-image-mask'><div class='fc-film'></div></div>",d=function(b){var c=a("<img />"),d=a.Deferred();return c.hide(),c.bind("load",function(){d.resolve(a(this))}),a("body").append(c),c.attr("src",b),a("#tempImg").remove(),d},e=function(){var b,c=a(window).width(),d=function(a){var b=!1;return b=a.minScreenWidth&&a.maxScreenWidth?c>=a.minScreenWidth&&c<=a.maxScreenWidth:a.maxScreenWidth?c<=a.maxScreenWidth:a.minScreenWidth?c>=a.minScreenWidth:!0};return this.options.frameSize.every(function(a){return d(a)?(b=a,!1):!0},this),b},f=function(){var b=a('script[src*="frame-carousel"]').attr("src").replace("jquery.frame-carousel.js","").replace("jquery.frame-carousel.min.js","")+"sample/";return this.options=a.extend({first:0,debug:!1,swipeThreshold:10,frame:b+"frame.png",frameSize:[{width:600,minScreenWidth:1200},{width:500,maxScreenWidth:1199,minScreenWidth:768},{width:300,maxScreenWidth:767}],boundingBox:{left:"4.3%",top:"4.48%",width:"91.4%",height:"61.1%"},images:function(){return[1,2,3,4,5,6,7,8,9,10].map(function(a){return b+a+".jpg"})}(),controlsPosition:{top:"35%"}},this.options),d(this.options.frame).then(a.proxy(function(b){var c={width:b.width(),height:b.height()},d=c.width/c.height;this.options.frameSize=this.options.frameSize.map(function(a){return a.width&&a.height||(!a.width&&a.height?a.width=a.height*d:a.width&&!a.height?a.height=a.width/d:a.width||a.height||(a.width=c.width,a.height=c.height)),a}),this.options.frameSize.push(c),this.attributes=a.extend(this.attributes,{originalFrameSize:c,current:0})},this))},g=function(){return this["goto"](this.attributes.current-1),!1},h=function(){return this["goto"](this.attributes.current+1),!1},i=function(b){var c={x:b.pageX,y:b.pageY},d=this.elements.$mask.width(),e=this.elements.$images.length,f=100/e,g=f*this.attributes.current;a.extend(this.attributes,{swipeStartPosition:c,screenWidth:d,screenCount:e,screenWidthAsPercentageOfFilm:f,screenOffset:g})},j=function(a){this.attributes.swipeDisplacement={x:(this.attributes.swipeStartPosition.x-a.pageX)/this.attributes.screenWidth*this.attributes.screenWidthAsPercentageOfFilm,y:this.attributes.swipeStartPosition.y-a.pageY},this.attributes.swipeCompoundDisplacement={x:this.attributes.swipeDisplacement.x+this.attributes.screenOffset,y:this.attributes.swipeDisplacement.y},this.attributes.swipeCompoundDisplacement.x<0&&(this.attributes.swipeCompoundDisplacement.x=0),this.attributes.swipeCompoundDisplacement.x+this.attributes.screenWidthAsPercentageOfFilm>100&&(this.attributes.swipeCompoundDisplacement.x=this.attributes.screenWidthAsPercentageOfFilm*(this.attributes.screenCount-1)),this["goto"](this.attributes.current,{animate:!1,updateStates:!1,distance:this.attributes.swipeCompoundDisplacement.x})},k=function(){this.attributes.thresholdAsPercentageOfFilm=this.options.swipeThreshold/100*this.attributes.screenWidthAsPercentageOfFilm,Math.abs(this.attributes.swipeDisplacement.x)>this.attributes.thresholdAsPercentageOfFilm?this.attributes.swipeDisplacement.x<0?this["goto"](this.attributes.current-1):this["goto"](this.attributes.current+1):this["goto"](this.attributes.current)},l=function(){this["goto"](this.attributes.current)},m=function(){this.attributes.is_animating=!1,this.elements.$film.css("transition","all 0s")},n=function(){this.$el.css(e.call(this))},o=function(){this.elements.$btn_go_left.fcRemoveClass("disabled"),this.elements.$btn_go_right.fcRemoveClass("disabled"),0===this.attributes.current?this.elements.$btn_go_left.fcAddClass("disabled"):this.attributes.current===this.elements.$images.length-1&&this.elements.$btn_go_right.fcAddClass("disabled")},p=function(){a(window).resize(a.proxy(function(){clearTimeout(this.attributes.resizeTimeout),this.attributes.resizeTimeout=setTimeout(a.proxy(n,this),500)},this)),this.$el.fcAddClass("fc").css({"background-image":"url('"+this.options.frame+"')"}).append(c),this.options.debug&&this.$el.fcAddClass("fc-debug"),this.$el.css(e.call(this)),this.elements=a.extend(this.elements,{$controls:this.$(".fc-controls"),$pgn_inner:this.$(".fc-pagination-inner"),$mask:this.$(".fc-image-mask"),$film:this.$(".fc-film"),$btn_go_left:this.$("a[rel=go-left]"),$btn_go_right:this.$el.find("a[rel=go-right]")}),this.options.controlsPosition&&this.elements.$controls.css(this.options.controlsPosition),this.elements.$mask.css(this.options.boundingBox).swipe({swipeStatus:a.proxy(function(b,c){c===a.fn.swipe.phases.PHASE_START?i.call(this,b):c===a.fn.swipe.phases.PHASE_MOVE?j.call(this,b):c===a.fn.swipe.phases.PHASE_END?k.call(this,b):c===a.fn.swipe.phases.PHASE_CANCEL&&l.call(this,b)},this),swipe:a.proxy(function(){},this),threshold:0,fingers:"all"}),this.elements.$film.css({width:100*this.options.images.length+"%"}).on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",a.proxy(m,this)),a.each(this.options.images,a.proxy(function(b,c){var d=a("<a/>").attr({href:"#"}).html("&nbsp;").click(a.proxy(function(){return this["goto"](b),!1},this)).appendTo(this.elements.$pgn_inner);a("<div/>").fcAddClass("fc-image-masked").fcAddClass("fc-animate").css(a.extend({"background-image":"url('"+c+"')"},this.options.boundingBox,{width:100/this.options.images.length+"%",height:"100%",left:100*b+"%"})).appendTo(this.elements.$film).on("change:class",a.proxy(function(a){"active"===a.className&&d[a.changeType]("active")},this))},this)),this.elements.$images=this.$(".fc-image-masked"),this.elements.$btn_go_left.click(a.proxy(g,this)),this.elements.$btn_go_right.click(a.proxy(h,this))};a.extend(b.prototype,{debug:function(a){this.options.debug&&this.$el.attr("data-debug",a)},count:function(){var a=this.$el.find(".fc-image-masked");return a.length},"goto":function(b,c){if(c=c||{},c=a.extend({animate:!0,updateStates:!0,distance:b*(100/this.elements.$images.length)},c),!(this.attributes.is_animating||0>b||b>this.elements.$images.length-1)){c.animate&&(this.attributes.is_animating=!0);var d=c.distance,e=0-d+"%",f={transform:"translate3d("+e+", 0, 0)"};c.animate&&(f.transition="all .4s ease-out"),this.elements.$film.css(f),c.animate&&setTimeout(a.proxy(function(){this.attributes.is_animating&&(this.attributes.is_animating=!1)},this),1e3),c.updateStates&&(this.attributes.current=b,this.elements.$images.fcRemoveClass("active"),this.elements.$images.eq(b).fcAddClass("active"),o.call(this))}}}),a.extend(a.fn,{frameCarousel:function(a){return this.each(function(){return new b(this,a)})},fcAddClass:function(b){var c=a.fn.addClass.apply(this,arguments);return a(this).trigger(a.Event("change:class",{target:this,changeType:"addClass",className:b})),c},fcRemoveClass:function(b){var c=a.fn.removeClass.apply(this,arguments);return a(this).trigger(a.Event("change:class",{target:this,changeType:"removeClass",className:b})),c}})}(jQuery);